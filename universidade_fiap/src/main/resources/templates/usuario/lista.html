<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragmentos :: cabecalho('Lista de Usuários')}" />

<body>
	<!-- Navbar -->
	<nav th:replace="~{fragmentos :: navbar}" />

	<div class="container-fluid py-4">
		<div th:replace="~{fragmentos :: saudacoes(${usuario_logado})}" />

		<!-- Alerts -->
		<div th:if="${param.sucesso}" class="alert alert-success-custom alert-dismissible fade show" role="alert">
			<i class="fas fa-check-circle me-2"></i>
			<strong>Sucesso!</strong> Usuário excluído com sucesso!
			<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
		</div>

		<div th:if="${param.erro}" class="alert alert-danger-custom alert-dismissible fade show" role="alert">
			<i class="fas fa-exclamation-triangle me-2"></i>
			<strong>Erro!</strong> <span th:text="${param.erro}"></span>
			<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
		</div>

		<!-- Header com botões -->
		<div class="row mb-4">
			<div class="col-12">
				<div class="d-flex justify-content-between align-items-center">
					<div>
						<h2 class="mb-0">
							<i class="fas fa-users me-2"></i>
							Lista de Usuários
						</h2>
						<p class="text-muted mb-0">Gerencie todos os usuários do sistema</p>
					</div>
					<div class="action-buttons">
						<a href="/usuario/novo" class="btn btn-primary-custom btn-custom">
							<i class="fas fa-plus me-1"></i>Novo Usuário
						</a>
						<a href="/" class="btn btn-secondary-custom btn-custom">
							<i class="fas fa-arrow-left me-1"></i>Voltar
						</a>
					</div>
				</div>
			</div>
		</div>

		<!-- Tabela de usuários -->
		<div class="row">
			<div class="col-12">
				<div class="card-custom">
					<div class="card-body p-0">
						<div class="table-responsive">
							<table class="table table-custom mb-0">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            <i class="fas fa-hashtag me-1"></i>ID
                                        </th>
                                        <th scope="col">
                                            <i class="fas fa-building me-1"></i>Filial
                                        </th>
                                        <th scope="col">
                                            <i class="fas fa-envelope me-1"></i>Email
                                        </th>
                                        <th scope="col">
                                            <i class="fas fa-id-card me-1"></i>CNPJ
                                        </th>
                                        <th scope="col">
                                            <i class="fas fa-user-tag me-1"></i>Perfil
                                        </th>
                                        <th scope="col">
                                            <i class="fas fa-calendar me-1"></i>Data Criação
                                        </th>
                                        <th scope="col" class="text-center">
                                            <i class="fas fa-cogs me-1"></i>Ações
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr th:each="usuario : ${usuarios}">
                                        <td th:text="${usuario.id}">1</td>
                                        <td th:text="${usuario.nomeFilial}">Filial Teste</td>
                                        <td th:text="${usuario.email}">admin@exemplo.com</td>
                                        <td th:text="${usuario.cnpj}">12345678000199</td>
                                        <td>
                                            <span class="badge bg-primary" th:text="${usuario.perfil.descricao}">ADMIN</span>
                                        </td>
                                        <td th:text="${#temporals.format(usuario.dataCriacao, 'dd/MM/yyyy HH:mm')}">13/09/2025 19:00</td>
                                        <td class="text-center">
                                            <div class="btn-group" role="group">
                                                <!-- Botão de exclusão -->
                                                <button type="button" 
                                                        class="btn btn-sm btn-danger-custom btn-custom"
                                                        title="Excluir Usuário"
                                                        th:onclick="'confirmarExclusao(\'' + @{/usuario/excluir/{id}(id=${usuario.id})} + '\', this)'">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr th:if="${#lists.isEmpty(usuarios)}">
                                        <td colspan="7" class="text-center py-4">
                                            <i class="fas fa-users fa-3x text-muted mb-3"></i>
                                            <p class="text-muted mb-0">Nenhum usuário cadastrado</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
	</div>

	<!-- Modal de confirmação -->
	<div th:replace="~{fragmentos :: modal-confirmacao}" />
	
	<!-- Scripts -->
	<div th:replace="~{fragmentos :: scripts}" />
</body>

</html>
